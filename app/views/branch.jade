extends layout
block script
	script.
		function ProfileBS(name, year, branch, attend) {
			var data = {
				name: name,
				year: year,
				branch: branch,
				attend: attend
			}
			var formData = new FormData();
			for (var key in data) {
				var value = data[key];
				formData.append(key, value);
			}
			var xhttp = new XMLHttpRequest();
			xhttp.open("POST", "branch_profile", true);
			xhttp.send(JSON.stringify(data));
			xhttp.onreadystatechange = function() {
				document.getElementById('profileData').innerHTML = xhttp.responseText;
			}
			
			//- $.ajax({
			//- 	url: "/branch_profile",
			//- 	type: "post",
			//- 	data: data,
			//- 	dataType: "json",
			//- 	success: function(data) {
			//- 		document.getElementById("profileData").innerHTML = data.message;
			//- 	},
			//- 	error: function(request) {
			//- 		alert("실패");
			//- 	}
			//- });
		}
		
block header_item02
	a.item.active(href="/branch")
		i.grid.layout.icon
		|Branchs
block content
	//- script(src="/javascript/menu.js")
	//- div.ui.masthead.vertical.tab.segment
	div.ui.secondary.pointing.menu
		div.ui.container
			a.active.item 전체 브랜치 현황
			a.item 부장 집사
			a.item 임원
			a.item 팀장
			a.item 브랜치 리더
	div.main.ui.container
		div.ui.grid
			div.twelve.wide.streched.column
				div.ui.segment
					h2.ui.header
						|#{year}년도 브랜치 편성
					div.ui.container
						table.ui.celled.striped.structured.table
							thead
								tr
									th 브랜치
									- bsList.forEach( function(item,index) {
									th #{item.branch._}	
									- });
									th 기타
							tfoot
								tr
									th(colspan="#{bsList.length+2}") 
										div.ui.borderless.small.right.floated.pagination.menu
											a.item(href="/branch?year=#{year}") <i class="child icon"></i> all
											a.item(href="/branch?year=#{year}&attendValue=1") <i class="frown icon"></i> bad
											a.item(href="/branch?year=#{year}&attendValue=2") <i class="meh icon"></i> well
											a.item(href="/branch?year=#{year}&attendValue=3") <i class="smile icon"></i> good
											a.item(href="/branch?year=#{year}&attendValue=4") <i class="thumbs outline up icon"></i> perfect
							tbody
								tr
									td: div.ui.ribbon.label 브랜치장
									each item in bsList
										td: label#profile(onclick="ProfileBS('#{item.RowKey._}','#{year}','#{item.branch._}','#{item.attend._}')") #{item.RowKey._}
									td 없음
								- for(var i = 0; i < maxNumber; i++) {
								tr 
									if i == 0
										td(rowspan="#{maxNumber}")
											div.ui.ribbon.label 청 2부
									each item in branchTable
										td 
											if item.length > i
												label#profile(onclick="ProfileBS('#{item[i].RowKey._}','#{year}','#{item[i].branch._}','#{item[i].attend._}')") #{item[i].RowKey._}
								- }
								- for(var i = 0; i < maxYoungNumber; i++) {
								tr 
									if i == 0
										td(rowspan="#{maxYoungNumber}") 
											div.ui.ribbon.label 청 1부
									each item in branchYoungTable
										td
											if item.length > i 
												label#profile(onclick="ProfileBS('#{item[i].RowKey._}','#{year}','#{item[i].branch._}','#{item[i].attend._}')") #{item[i].RowKey._}
								- }
								- for(var i = 0; i < maxArmy; i++) {
								tr 
									if i == 0
										td(rowspan="#{maxArmy}") 
											div.ui.ribbon.label 군입대자
									each item in armyTable
										td
											if item.length > i 
												label#profile(onclick="ProfileBS('#{item[i].RowKey._}','#{year}','#{item[i].branch._}','#{item[i].attend._}')") #{item[i].RowKey._}
									td
								- }
								- for(var i = 0; i < maxOther; i++) {
								tr 
									if i == 0
										td(rowspan="#{maxOther}") 
											div.ui.ribbon.label 유학자 및 지방근무자
									each item in otherTable
										td
											if item.length > i 
												label#profile(onclick="ProfileBS('#{item[i].RowKey._}','#{year}','#{item[i].branch._}','#{item[i].attend._}')") #{item[i].RowKey._}
									td
								- }
			div#profileData.four.wide.column
				include profile